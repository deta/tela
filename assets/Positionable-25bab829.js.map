{"version":3,"file":"Positionable-25bab829.js","sources":["../../node_modules/.pnpm/svelte@4.2.0/node_modules/svelte/src/runtime/internal/globals.js","../../node_modules/.pnpm/svelte@4.2.0/node_modules/svelte/src/runtime/store/index.js","../../src/lib/utils.ts","../../src/lib/Board.svelte","../../src/lib/Positionable.svelte"],"sourcesContent":["/** @type {typeof globalThis} */\nexport const globals =\n\ttypeof window !== 'undefined'\n\t\t? window\n\t\t: typeof globalThis !== 'undefined'\n\t\t? globalThis\n\t\t: // @ts-ignore Node typings have this\n\t\t  global;\n","import {\n\trun_all,\n\tsubscribe,\n\tnoop,\n\tsafe_not_equal,\n\tis_function,\n\tget_store_value\n} from '../internal/index.js';\n\nconst subscriber_queue = [];\n\n/**\n * Creates a `Readable` store that allows reading by subscription.\n *\n * https://svelte.dev/docs/svelte-store#readable\n * @template T\n * @param {T} [value] initial value\n * @param {import('./public.js').StartStopNotifier<T>} [start]\n * @returns {import('./public.js').Readable<T>}\n */\nexport function readable(value, start) {\n\treturn {\n\t\tsubscribe: writable(value, start).subscribe\n\t};\n}\n\n/**\n * Create a `Writable` store that allows both updating and reading by subscription.\n *\n * https://svelte.dev/docs/svelte-store#writable\n * @template T\n * @param {T} [value] initial value\n * @param {import('./public.js').StartStopNotifier<T>} [start]\n * @returns {import('./public.js').Writable<T>}\n */\nexport function writable(value, start = noop) {\n\t/** @type {import('./public.js').Unsubscriber} */\n\tlet stop;\n\t/** @type {Set<import('./private.js').SubscribeInvalidateTuple<T>>} */\n\tconst subscribers = new Set();\n\t/** @param {T} new_value\n\t * @returns {void}\n\t */\n\tfunction set(new_value) {\n\t\tif (safe_not_equal(value, new_value)) {\n\t\t\tvalue = new_value;\n\t\t\tif (stop) {\n\t\t\t\t// store is ready\n\t\t\t\tconst run_queue = !subscriber_queue.length;\n\t\t\t\tfor (const subscriber of subscribers) {\n\t\t\t\t\tsubscriber[1]();\n\t\t\t\t\tsubscriber_queue.push(subscriber, value);\n\t\t\t\t}\n\t\t\t\tif (run_queue) {\n\t\t\t\t\tfor (let i = 0; i < subscriber_queue.length; i += 2) {\n\t\t\t\t\t\tsubscriber_queue[i][0](subscriber_queue[i + 1]);\n\t\t\t\t\t}\n\t\t\t\t\tsubscriber_queue.length = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @param {import('./public.js').Updater<T>} fn\n\t * @returns {void}\n\t */\n\tfunction update(fn) {\n\t\tset(fn(value));\n\t}\n\n\t/**\n\t * @param {import('./public.js').Subscriber<T>} run\n\t * @param {import('./private.js').Invalidator<T>} [invalidate]\n\t * @returns {import('./public.js').Unsubscriber}\n\t */\n\tfunction subscribe(run, invalidate = noop) {\n\t\t/** @type {import('./private.js').SubscribeInvalidateTuple<T>} */\n\t\tconst subscriber = [run, invalidate];\n\t\tsubscribers.add(subscriber);\n\t\tif (subscribers.size === 1) {\n\t\t\tstop = start(set, update) || noop;\n\t\t}\n\t\trun(value);\n\t\treturn () => {\n\t\t\tsubscribers.delete(subscriber);\n\t\t\tif (subscribers.size === 0 && stop) {\n\t\t\t\tstop();\n\t\t\t\tstop = null;\n\t\t\t}\n\t\t};\n\t}\n\treturn { set, update, subscribe };\n}\n\n/**\n * Derived value store by synchronizing one or more readable stores and\n * applying an aggregation function over its input values.\n *\n * https://svelte.dev/docs/svelte-store#derived\n * @template {import('./private.js').Stores} S\n * @template T\n * @overload\n * @param {S} stores - input stores\n * @param {(values: import('./private.js').StoresValues<S>, set: (value: T) => void, update: (fn: import('./public.js').Updater<T>) => void) => import('./public.js').Unsubscriber | void} fn - function callback that aggregates the values\n * @param {T} [initial_value] - initial value\n * @returns {import('./public.js').Readable<T>}\n */\n\n/**\n * Derived value store by synchronizing one or more readable stores and\n * applying an aggregation function over its input values.\n *\n * https://svelte.dev/docs/svelte-store#derived\n * @template {import('./private.js').Stores} S\n * @template T\n * @overload\n * @param {S} stores - input stores\n * @param {(values: import('./private.js').StoresValues<S>) => T} fn - function callback that aggregates the values\n * @param {T} [initial_value] - initial value\n * @returns {import('./public.js').Readable<T>}\n */\n\n/**\n * @template {import('./private.js').Stores} S\n * @template T\n * @param {S} stores\n * @param {Function} fn\n * @param {T} [initial_value]\n * @returns {import('./public.js').Readable<T>}\n */\nexport function derived(stores, fn, initial_value) {\n\tconst single = !Array.isArray(stores);\n\t/** @type {Array<import('./public.js').Readable<any>>} */\n\tconst stores_array = single ? [stores] : stores;\n\tif (!stores_array.every(Boolean)) {\n\t\tthrow new Error('derived() expects stores as input, got a falsy value');\n\t}\n\tconst auto = fn.length < 2;\n\treturn readable(initial_value, (set, update) => {\n\t\tlet started = false;\n\t\tconst values = [];\n\t\tlet pending = 0;\n\t\tlet cleanup = noop;\n\t\tconst sync = () => {\n\t\t\tif (pending) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tcleanup();\n\t\t\tconst result = fn(single ? values[0] : values, set, update);\n\t\t\tif (auto) {\n\t\t\t\tset(result);\n\t\t\t} else {\n\t\t\t\tcleanup = is_function(result) ? result : noop;\n\t\t\t}\n\t\t};\n\t\tconst unsubscribers = stores_array.map((store, i) =>\n\t\t\tsubscribe(\n\t\t\t\tstore,\n\t\t\t\t(value) => {\n\t\t\t\t\tvalues[i] = value;\n\t\t\t\t\tpending &= ~(1 << i);\n\t\t\t\t\tif (started) {\n\t\t\t\t\t\tsync();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t() => {\n\t\t\t\t\tpending |= 1 << i;\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\tstarted = true;\n\t\tsync();\n\t\treturn function stop() {\n\t\t\trun_all(unsubscribers);\n\t\t\tcleanup();\n\t\t\t// We need to set this to false because callbacks can still happen despite having unsubscribed:\n\t\t\t// Callbacks might already be placed in the queue which doesn't know it should no longer\n\t\t\t// invoke this derived store.\n\t\t\tstarted = false;\n\t\t};\n\t});\n}\n\n/**\n * Takes a store and returns a new one derived from the old one that is readable.\n *\n * https://svelte.dev/docs/svelte-store#readonly\n * @template T\n * @param {import('./public.js').Readable<T>} store  - store to make readonly\n * @returns {import('./public.js').Readable<T>}\n */\nexport function readonly(store) {\n\treturn {\n\t\tsubscribe: store.subscribe.bind(store)\n\t};\n}\n\nexport { get_store_value as get };\n","export const lerp = (a: number, b: number, t: number) => a * (1 - t) + b * t;\nexport const clamp = (a: number, min = 0, max = 1) => Math.min(max, Math.max(min, a));\nexport const invlerp = (x: number, y: number, a: number) => clamp((a - x) / (y - x));\nexport const map = (x1: number, y1: number, x2: number, y2: number, a: number) =>\n  lerp(x2, y2, invlerp(x1, y1, a));\n\nexport function hasClassOrParentWithClass(element: HTMLElement, className: string): boolean {\n  if (!element) {\n    return false;\n  }\n\n  if (element.classList.contains(className)) {\n    return true;\n  }\n\n  if (element.parentElement) return hasClassOrParentWithClass(element.parentElement, className);\n  else return false;\n}\n\nexport function snapToGrid(value: number, snap: number): number {\n  return Math.round(value / snap) * snap;\n}\n\nconst debounceMap = new Map();\nexport function debounce(id: string, ms: number, callback: () => void) {\n  if (debounceMap.has(id)) clearTimeout(debounceMap.get(id));\n  const timer = setTimeout(callback, ms);\n  debounceMap.set(id, timer);\n}\n\nexport function isBrowser() {\n  return typeof window !== \"undefined\";\n}","<script lang=\"ts\">\n  import { writable, type Writable } from \"svelte/store\";\n  import type { TBoard, TBoardMode, TBoardSettings } from \"./types/Board.type.js\";\n  import { clamp, debounce, hasClassOrParentWithClass } from \"./utils.js\";\n  import { createEventDispatcher, onMount, setContext } from \"svelte\";\n\n  export let settings: Writable<Partial<TBoardSettings>>;\n  export let board: Writable<Partial<TBoard>>;\n\n  const dispatch = createEventDispatcher();\n\n  // Defaults\n  $settings = {\n    CAN_ZOOM: true,\n    SNAP_TO_GRID: false,\n    GRID_SIZE: 20,\n\n    CULL: true,\n    CULL_MARGIN: 400,\n\n    DEV: {\n      SHOW_POS: false,\n      SHOW_MODE: false\n    },\n    ...$settings,\n    BOUNDS: {\n      minX: null,\n      maxX: null,\n      minY: null,\n      maxY: null,\n      maxZoom: 3,\n      minZoom: 0,\n      limit: \"hard\",\n      ...$settings.BOUNDS\n    },\n  } satisfies TBoardSettings;\n\n  $board = {\n    zoom: 1,\n    viewOffset: { x: 0, y: 0 },\n    viewSize: { x: 1280, y: 720 },\n    viewPort: { x: 0, y: 0, w: 0, h: 0 },\n    ...$board\n  } satisfies TBoard;\n\n  setContext(\"board\", board);\n  setContext(\"settings\", settings);\n\n  let mode = writable<TBoardMode>(\"draw\");\n  setContext(\"mode\", mode);\n\n  let containerEl: HTMLDivElement;\n  let dragState = {\n    init: { x: 0, y: 0 },\n    curr: { x: 0, y: 0 },\n    offset: { x: 0, y: 0 }\n  };\n\n  let selectState = {\n    init: { x: 0, y: 0 },\n    curr: { x: 0, y: 0 },\n    offset: { x: 0, y: 0 },\n    pos: { x: 0, y: 0 },\n    size: { x: 0, y: 0 }\n  };\n\n  $: transformCss = `transform-origin: top left; transform: scale(${\n    $board.zoom\n  }) translate(${-$board.viewOffset.x}px, ${-$board.viewOffset.y}px);`;\n\n  // $: selectionCss = `transform: translate(${\n  //   $settings.SNAP_TO_GRID ? snapToGrid(Math.floor($board.viewOffset.x + (selectState.pos.x - 0.5) / $board.zoom), $settings.GRID_SIZE!) : $board.viewOffset.x + selectState.pos.x / $board.zoom\n  // }px, ${\n  //   $settings.SNAP_TO_GRID ? snapToGrid(Math.floor($board.viewOffset.y + (selectState.pos.y - 0.5) / $board.zoom), $settings.GRID_SIZE!) : $board.viewOffset.y + selectState.pos.y / $board.zoom\n  // }px); width: ${\n  //   $settings.SNAP_TO_GRID ? snapToGrid(Math.round(selectState.size.x + 0.5), $settings.GRID_SIZE!) : Math.round(selectState.size.x)\n  // }px; height: ${\n  //   $settings.SNAP_TO_GRID ? snapToGrid(Math.round(selectState.size.y + 0.5), $settings.GRID_SIZE!) : Math.round(selectState.size.y)\n  // }px;`;\n\n  $: selectionCss = `transform: translate(${\n    $board.viewOffset.x + selectState.pos.x / $board.zoom\n  }px, ${$board.viewOffset.y + selectState.pos.y / $board.zoom}px); width: ${Math.round(\n    selectState.size.x\n  )}px; height: ${Math.round(selectState.size.y)}px;`;\n\n  $: modeCursorCss = `cursor: ${\n    $mode === \"draw\"\n      ? \"crosshair\"\n      : $mode === \"select\"\n      ? \"default\"\n      : $mode === \"pan\"\n      ? \"grab\"\n      : $mode === \"panning\"\n      ? \"grabbing\"\n      : \"crosshair\"\n  };`;\n\n  // if ($settings.BOUNDS?.minX !== null && $board.viewOffset.x < $settings.BOUNDS!.minX) {\n  //   $board.viewOffset.x = $settings.BOUNDS!.minX;\n  // }\n  // if ($settings.BOUNDS?.minY !== null && $board.viewOffset.y < $settings.BOUNDS!.minY) {\n  //   $board.viewOffset.y = $settings.BOUNDS!.minY;\n  // }\n  // if ($settings.BOUNDS?.maxX !== null && $board.viewOffset.x > $settings.BOUNDS!.maxX - window.innerWidth) {\n  //   $board.viewOffset.x = $settings.BOUNDS!.maxX - window.innerWidth;\n  // }\n  // if ($settings.BOUNDS?.maxY !== null && $board.viewOffset.y > $settings.BOUNDS!.maxY - window.innerHeight) {\n  //   $board.viewOffset.y = $settings.BOUNDS!.maxY - window.innerHeight;\n  // }\n\n  // Utils\n  function posToViewportPos(x: number, y: number) {\n    return {\n      x: x - $board.viewPort.x,\n      y: y - $board.viewPort.y + window.scrollY\n    };\n  }\n  function startDrawing() {\n    document.body.classList.add(\"drawing\");\n    dispatch(\"drawStart\");\n  }\n  function stopDrawing() {\n    document.body.classList.remove(\"drawing\");\n    document.removeEventListener(\"mousemove\", onMouseMoveDraw);\n    selectState = {\n      init: { x: 0, y: 0 },\n      curr: { x: 0, y: 0 },\n      offset: { x: 0, y: 0 },\n      pos: { x: 0, y: 0 },\n      size: { x: 0, y: 0 }\n    };\n  }\n  function startPanning() {\n    document.body.classList.add(\"panning\");\n  }\n  function stopPanning() {\n    document.body.classList.remove(\"panning\");\n    document.removeEventListener(\"mousemove\", onMouseMovePan);\n    dispatch(\"panEnd\", { offset: $board.viewOffset });\n  }\n\n  function startSelect() {\n    dispatch(\"selectStart\");\n    document.body.classList.add(\"selecting\");\n    document.addEventListener(\"mousemove\", onMouseMoveSelect);\n  }\n  function stopSelect() {\n    document.body.classList.remove(\"selecting\");\n    document.removeEventListener(\"mousemove\", onMouseMoveSelect);\n  }\n\n  // UI Handlers\n  function onWheel(e: WheelEvent) {\n    if (e.ctrlKey) {\n      e.preventDefault();\n      e.stopPropagation();\n      if (!$settings.CAN_ZOOM) return;\n\n      $mode = \"zoom\";\n\n      // todo: fix relative to bounding element box not screen pos\n      const absoluteMouseXOld = $board.viewOffset.x + e.clientX / $board.zoom;\n      const absoluteMouseYOld = $board.viewOffset.y + e.clientY / $board.zoom;\n\n      const delta = e.deltaY;\n      const zoom = clamp($board.zoom - delta / 500, 0.1, 1.9);\n      $board.zoom = zoom;\n\n      const absoluteMouseXNew = $board.viewOffset.x + e.clientX / zoom;\n      const absoluteMouseYNew = $board.viewOffset.y + e.clientY / zoom;\n\n      const offsetX = absoluteMouseXOld - absoluteMouseXNew;\n      const offsetY = absoluteMouseYOld - absoluteMouseYNew;\n\n      $board.viewOffset = {\n        x: $board.viewOffset.x + offsetX,\n        y: $board.viewOffset.y + offsetY\n      };\n    } else {\n      if (hasClassOrParentWithClass(e.target as HTMLElement, \"tela-ignore\")) return;\n      e.preventDefault();\n      e.stopPropagation();\n\n      const deltaX = e.deltaX;\n      const deltaY = e.deltaY;\n\n      const boundX = clamp(\n        $board.viewOffset.x + deltaX,\n        $settings.BOUNDS!.minX !== null ? $settings.BOUNDS!.minX : -Infinity,\n        $settings.BOUNDS!.maxX !== null ? $settings.BOUNDS!.maxX - window.innerWidth : Infinity // todo: use bounding rect\n      );\n      const boundY = clamp(\n        $board.viewOffset.y + deltaY,\n        $settings.BOUNDS!.minY !== null ? $settings.BOUNDS!.minY : -Infinity,\n        $settings.BOUNDS!.maxY !== null ? $settings.BOUNDS!.maxY - window.innerHeight : Infinity\n      );\n\n      $board.viewOffset = {\n        x: boundX,\n        y: boundY\n      };\n      debounce(\"remove_trackpad_panning\", 100, () => document.body.classList.remove(\"panning\"));\n    }\n    dispatch(\"zoomEnd\", { zoom: $board.zoom });\n    //transformCss = `transform: translate(${-$board.viewOffset.x}px, ${-$board.viewOffset.y}px) scale(${$board.zoom});`;\n  }\n\n  function onKeyDown(e: KeyboardEvent) {\n    if (e.shiftKey) {\n      mode.set(\"select\");\n    } else if (e.metaKey) {\n      mode.set(\"pan\");\n    }\n  }\n\n  function onKeyUp(e: KeyboardEvent) {\n    if (!e.shiftKey && !e.metaKey) {\n      $mode === \"draw\" && stopDrawing();\n      ($mode === \"pan\" || $mode === \"panning\") && stopPanning();\n      $mode === \"select\" && stopSelect();\n      mode.set(\"draw\");\n    }\n  }\n\n  function onMouseDown(e: MouseEvent | TouchEvent) {\n    const target = (e as TouchEvent).targetTouches?.item(0)?.target || (e as MouseEvent).target;\n    const { x: clientX, y: clientY } = posToViewportPos(\n      (e as TouchEvent).targetTouches?.item(0)?.clientX || (e as MouseEvent).clientX,\n      (e as TouchEvent).targetTouches?.item(0)?.clientY || (e as MouseEvent).clientY\n    );\n\n    if (hasClassOrParentWithClass(target as HTMLElement, \"tela-ignore\")) return;\n    if ($mode === \"pan\" || (e as TouchEvent).targetTouches?.length === 1) {\n      mode.set(\"panning\");\n    }\n\n    if ($mode === \"draw\") {\n      e.stopPropagation();\n      startDrawing();\n\n      selectState.init = { x: clientX, y: clientY };\n      selectState.curr = { x: clientX, y: clientY };\n      selectState.pos = { x: clientX, y: clientY };\n      selectState.size = { x: 0, y: 0 };\n\n      document.addEventListener(\"mousemove\", onMouseMoveDraw);\n      document.addEventListener(\"mouseup\", onMouseUp, { once: true });\n    } else if ($mode === \"panning\") {\n      e.stopPropagation();\n      startPanning();\n\n      dragState.init = { x: clientX, y: clientY };\n      dragState.curr = { x: clientX, y: clientY };\n\n      document.addEventListener(\"mousemove\", onMouseMovePan);\n      document.addEventListener(\"mouseup\", onMouseUp, { once: true });\n      document.addEventListener(\"touchmove\", onMouseMovePan);\n      document.addEventListener(\"touchend\", onMouseUp, { once: true });\n    } else if ($mode === \"select\") {\n      e.stopPropagation();\n      startSelect();\n\n      selectState.init = { x: clientX, y: clientY };\n      selectState.curr = { x: clientX, y: clientY };\n      selectState.pos = { x: clientX, y: clientY };\n      selectState.size = { x: 0, y: 0 };\n\n      document.addEventListener(\"mousemove\", onMouseMoveSelect);\n      document.addEventListener(\"mouseup\", onMouseUp, { once: true });\n    }\n  }\n\n  function onMouseMovePan(e: MouseEvent | TouchEvent) {\n    const clientX = (e as TouchEvent).targetTouches?.item(0)?.clientX || (e as MouseEvent).clientX;\n    const clientY = (e as TouchEvent).targetTouches?.item(0)?.clientY || (e as MouseEvent).clientY;\n\n    dragState.offset = {\n      x: Math.floor(clientX - dragState.curr.x),\n      y: Math.floor(clientY - dragState.curr.y)\n    };\n\n    dragState.curr = { x: clientX, y: clientY };\n\n    const boundX = clamp(\n      $board.viewOffset.x - dragState.offset.x,\n      $settings.BOUNDS!.minX !== null ? $settings.BOUNDS!.minX : -Infinity,\n      $settings.BOUNDS!.maxX !== null ? $settings.BOUNDS!.maxX - window.innerWidth : Infinity\n    );\n    const boundY = clamp(\n      $board.viewOffset.y - dragState.offset.y,\n      $settings.BOUNDS!.minY !== null ? $settings.BOUNDS!.minY : -Infinity,\n      $settings.BOUNDS!.maxY !== null ? $settings.BOUNDS!.maxY - window.innerHeight : Infinity\n    );\n\n    $board.viewOffset = {\n      x: boundX, //$board.viewOffset.x - dragState.offset.x,\n      y: boundY //$board.viewOffset.y - dragState.offset.y\n    };\n\n    //transformCss = `transform: translate(${-$board.viewOffset.x}px, ${-$board.viewOffset.y}px) scale(${$board.zoom});`;\n  }\n\n  function onMouseMoveSelect(e: MouseEvent) {\n    selectState.offset = {\n      x: -Math.floor(selectState.init.x - selectState.curr.x),\n      y: -Math.floor(selectState.init.y - selectState.curr.y)\n    };\n\n    selectState.pos.x = selectState.init.x;\n    selectState.pos.y = selectState.init.y;\n\n    selectState.size.x = selectState.offset.x / $board.zoom;\n    selectState.size.y = selectState.offset.y / $board.zoom;\n\n    if (selectState.size.x < 0) {\n      selectState.size.x = Math.abs(selectState.offset.x / $board.zoom);\n      selectState.pos.x = selectState.init.x - selectState.size.x * $board.zoom;\n    }\n    if (selectState.size.y < 0) {\n      selectState.size.y = Math.abs(selectState.offset.y / $board.zoom);\n      selectState.pos.y = selectState.init.y - selectState.size.y * $board.zoom;\n    }\n\n    selectState.curr = { x: e.clientX, y: e.clientY };\n    dispatch(\"selectMove\", { selectState });\n  }\n\n  function onMouseMoveDraw(e: MouseEvent | TouchEvent) {\n    const { x: clientX, y: clientY } = posToViewportPos(\n      (e as TouchEvent).targetTouches?.item(0)?.clientX || (e as MouseEvent).clientX,\n      (e as TouchEvent).targetTouches?.item(0)?.clientY || (e as MouseEvent).clientY\n    );\n\n    selectState.offset = {\n      x: -Math.floor(selectState.init.x - selectState.curr.x),\n      y: -Math.floor(selectState.init.y - selectState.curr.y)\n    };\n\n    selectState.pos.x = selectState.init.x;\n    selectState.pos.y = selectState.init.y;\n\n    selectState.size.x = selectState.offset.x / $board.zoom;\n    selectState.size.y = selectState.offset.y / $board.zoom;\n\n    if (selectState.size.x < 0) {\n      selectState.size.x = Math.abs(selectState.offset.x / $board.zoom);\n      selectState.pos.x = selectState.init.x - selectState.size.x * $board.zoom;\n    }\n    if (selectState.size.y < 0) {\n      selectState.size.y = Math.abs(selectState.offset.y / $board.zoom);\n      selectState.pos.y = selectState.init.y - selectState.size.y * $board.zoom;\n    }\n\n    selectState.curr = { x: clientX, y: clientY };\n  }\n\n  function onMouseUp(e: MouseEvent | TouchEvent) {\n    if ($mode === \"draw\") {\n      dispatch(\"drawEnd\", { selection: { pos: selectState.pos, size: selectState.size } });\n      stopDrawing();\n    } else if ($mode === \"panning\") {\n      $mode = \"pan\";\n      stopPanning();\n    } else if ($mode === \"select\") {\n      stopSelect();\n      dispatch(\"selectEnd\", { selectState });\n      selectState = {\n        init: { x: 0, y: 0 },\n        curr: { x: 0, y: 0 },\n        offset: { x: 0, y: 0 },\n        pos: { x: 0, y: 0 },\n        size: { x: 0, y: 0 }\n      };\n    }\n\n    //transformCss = `transform: translate(${-$board.viewOffset.x}px, ${-$board.viewOffset.y}px) scale(${$board.zoom});`;\n  }\n\n  onMount(() => {\n    const rec = containerEl.getBoundingClientRect();\n    $board.viewPort = {\n      x: rec.x,\n      y: rec.y,\n      w: rec.right - rec.left,\n      h: rec.bottom - rec.top\n    }\n  });\n</script>\n\n{#if Object.values($settings.DEV).includes(true)}\n  <!-- todo: add dev toggle -->\n  <div\n    style=\"position: absolute; right: 1ch; top: 1ch; background: darkblue; z-index: 200; color: #fff; padding: 4px; display: flex; gap: 2ch; user-select: none; pointer-events: none;\"\n  >\n    {#if $settings.DEV?.SHOW_POS}\n      <span>{$board.viewOffset.x} - {$board.viewOffset.y}</span>\n    {/if}\n    {#if $settings.DEV?.SHOW_MODE}\n      <span>{$mode}</span>\n    {/if}\n  </div>\n{/if}\n\n<svelte:window on:keydown={onKeyDown} on:keyup={onKeyUp} />\n\n<div\n  class=\"container\"\n  style={modeCursorCss}\n  on:mousedown={onMouseDown}\n  on:touchstart|nonpassive={onMouseDown}\n  on:wheel|nonpassive={onWheel}\n  bind:this={containerEl}\n>\n  <div class=\"board\" style={transformCss}>\n    {#if $mode === \"select\" || $mode === \"draw\"}\n      <div class=\"selection-rect\" style={selectionCss} />\n      <!-- <div id=\"dragIntercept\">\n        <div id=\"selectionRect\" style={selectionCss} bind:this={selectionRectEl} />\n      </div> -->\n    {/if}\n\n    <slot />\n  </div>\n</div>\n\n<style>\n  .container {\n    width: 100%;\n    height: 100%;\n\n    overflow: hidden;\n    /* overscroll-behavior: contain; */\n  }\n  .board {\n    position: relative;\n    height: 100%;\n    overflow: visible;\n\n    will-change: transform;\n    isolation: isolate;\n\n    transform-style: preserve-3d;\n    backface-visibility: hidden;\n  }\n\n  .selection-rect {\n    position: absolute;\n    top: 0;\n    left: 0;\n    z-index: 99999;\n    background: rgba(0, 0, 0, 0.1);\n  }\n</style>\n","<script lang=\"ts\">\n  import { getContext } from \"svelte\";\n  import type { Writable } from \"svelte/store\";\n  import type { Vec2 } from \"./types/Utils.type.js\";\n  import type { TBoard, TBoardSettings } from \"./types/Board.type.js\";\n  import { isBrowser, snapToGrid } from \"./utils.js\";\n\n  export let pos: Vec2;\n  export let size: Vec2;\n  export let z: number = 1;\n\n  const board = getContext<Writable<TBoard>>(\"board\");\n  const settings = getContext<Writable<TBoardSettings>>(\"settings\");\n\n  $: transformCss = `transform: translate(${\n    $settings.SNAP_TO_GRID ? snapToGrid(pos.x, $settings.GRID_SIZE!) : pos.x\n  }px, ${\n    $settings.SNAP_TO_GRID ? snapToGrid(pos.y, $settings.GRID_SIZE!) : pos.y\n  }px); width: ${\n    $settings.SNAP_TO_GRID ? snapToGrid(size.x, $settings.GRID_SIZE!) : size.x\n  }px; height: ${\n    $settings.SNAP_TO_GRID ? snapToGrid(size.y, $settings.GRID_SIZE!) : size.y\n  }px; z-index: ${z};`;\n  $: inView = isVisible($board.viewOffset)\n\n  function isVisible(viewOffset: Vec2, viewport: Vec2 = { x: 620, y: 340 }) {\n    if (isBrowser()) {\n      viewport.x = window.innerWidth;\n      viewport.y = window.innerHeight;\n    }\n    return (\n      pos.x > viewOffset.x - $settings.CULL_MARGIN! &&\n      pos.y > viewOffset.y - $settings.CULL_MARGIN! &&\n      pos.x + size.x < viewOffset.x + $settings.CULL_MARGIN! + viewport.x / $board.zoom && // todo: use bounding rect not window\n      pos.y + size.y < viewOffset.y + $settings.CULL_MARGIN! + viewport.y / $board.zoom\n    );\n  }\n\n</script>\n\n{#if !$settings.CULL || inView}\n<svelte:element\n  this=\"div\"\n  {...$$restProps}\n  class=\"positionable {$$restProps.class || ''}\"\n  style=\"{transformCss} {$$restProps.style || ''}\"\n>\n  <slot />\n</svelte:element>\n{/if}\n\n<style>\n  .positionable {\n    position: absolute;\n    top: 0;\n    left: 0;\n    transform-origin: top left;\n\n    transform-style: preserve-3d;\n    backface-visibility: hidden;\n  }\n</style>\n"],"names":["globals","subscriber_queue","writable","value","start","noop","stop","subscribers","set","new_value","safe_not_equal","run_queue","subscriber","i","update","fn","subscribe","run","invalidate","clamp","a","min","max","hasClassOrParentWithClass","element","className","snapToGrid","snap","debounceMap","debounce","id","ms","callback","timer","isBrowser","_a","ctx","create_if_block_3","_b","create_if_block_2","insert_hydration","target","div","anchor","span","set_data","t0","t0_value","t2","t2_value","if_block1","create_if_block","div1","append_hydration","div0","startPanning","settings","$$props","board","dispatch","createEventDispatcher","$settings","$board","setContext","mode","containerEl","dragState","selectState","posToViewportPos","x","y","startDrawing","stopDrawing","onMouseMoveDraw","$$invalidate","stopPanning","onMouseMovePan","startSelect","onMouseMoveSelect","stopSelect","onWheel","e","$mode","absoluteMouseXOld","absoluteMouseYOld","delta","zoom","set_store_value","absoluteMouseXNew","absoluteMouseYNew","offsetX","offsetY","deltaX","deltaY","boundX","boundY","onKeyDown","onKeyUp","onMouseDown","clientX","clientY","_d","_c","_f","_e","_g","onMouseUp","onMount","rec","$$value","transformCss","selectionCss","modeCursorCss","div_style_value","div_class_value","current","dirty","pos","size","z","getContext","isVisible","viewOffset","viewport","inView"],"mappings":"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","x_google_ignoreList":[0,1]}